<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>remcpy</title>
    <style>
        body {
            background-color: white;
            color: rgb(41, 190, 176);
            font-family: 'Ubuntu';
            font-size: 250%;
            text-align: center;
        }
        button {
            border: none;
            color:rgb(41, 190, 176);
            font-size: 70%;
            margin-top: 5%;
            width: 90%;
        }
        button:hover {
            background-color: rgb(210, 210, 210);
            cursor: pointer;
        }

        input {
            border-top: none;
            border-left: none;
            border-right: none;
            font-size: 60%;
        }
        input:focus {
            outline: none;
        }

        header {
            background-color: rgb(41, 190, 176);
            color: white;
        }
    </style>
</head>
<body>
    <header>remcpy</header>
    <form>
        <h5>Enter Text</h5>
        <input type="text" placeholder="Enter text..." id="tbc">
        <br>
        <button type="submit">Copy</button>
        <h6 id="warning"></h6>
    </form>
    <script>

        /*
            Check if cookies contain 'JWT' cookie which is
            provided by the server on password verification (login)

            If 'JWT' cookie is not found, it provides text on
            'warning' id, that warns the user that the request
            can't take place
        */

        const cookies = document.cookie.split('; ');
        let isLoggedIn = false
        for(let x in cookies) {
            if(cookies[x].startsWith('JWT')) {
                isLoggedIn = true;
                break;
            }
        }
        
        const warning = document.getElementById('warning')
        if(!isLoggedIn) {
            warning.style.color = "red"; //Red because it's a warning (obviously)
            warning.innerHTML = "won't be able to successfully execute request if you are not logged in";
        } else {

            //If JWT cookie exists -> specify submit event handler

            //Handle Form Submit Event
            document.querySelector('form').onsubmit = async e => {
                e.preventDefault();

                //body parameter
                let text = document.getElementById("tbc").value;
                
                //POST request execution
                fetch('/api', {
                    method: 'POST',
                    headers: new Headers({'content-type': 'application/x-www-form-urlencoded'}),
                    body: `text=${text}`
                })
            }
        }
    </script>
</body>
</html>
